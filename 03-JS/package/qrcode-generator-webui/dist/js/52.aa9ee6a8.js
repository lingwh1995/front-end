"use strict";(self["webpackChunkqrcode_generator_webui"]=self["webpackChunkqrcode_generator_webui"]||[]).push([[52],{6994:function(e,l,t){t.d(l,{Jp:function(){return n},Wq:function(){return r},Zp:function(){return u},iM:function(){return d},w_:function(){return i},yo:function(){return o}});var a=t(2730);function r(e){return(0,a.A)({url:`/dict/scheme_id/${e.schemeId}/level/${e.level}`,method:"GET"})}function n(e){return(0,a.A)({url:`/dict/scheme_id/${e.schemeId}`,method:"GET"})}function d(e){return(0,a.A)({url:"/dict",method:"POST",data:e})}function i(e){return(0,a.A)({url:`/dict/recursive/${e}`,method:"DELETE"})}function u(e){return(0,a.A)({url:`/dict/scheme_id/${e.schemeId}/dict_code/${e.dictCode}`,method:"GET"})}function o(e){return(0,a.A)({url:"/dict",method:"PUT",data:e})}},8992:function(e,l,t){t.d(l,{Ao:function(){return o},KZ:function(){return i},Ox:function(){return d},W9:function(){return r},qE:function(){return u},wz:function(){return n}});var a=t(2730);function r(e){return(0,a.A)({url:"/rule",method:"POST",data:e})}function n(e){return(0,a.A)({url:`/rule/for_select/${e}`,method:"GET"})}function d(e){return(0,a.A)({url:`/rule/pagination/${e.currentPage}/${e.pageSize}`,method:"GET"})}function i(e,l){return(0,a.A)({url:`/rule/pagination/${e.currentPage}/${e.pageSize}/${""==l.ruleName?null:l.ruleName}`,method:"GET"})}function u(e){return(0,a.A)({url:`/rule/${e}`,method:"DELETE"})}function o(e){return(0,a.A)({url:"/rule",method:"PUT",data:e})}},2781:function(e,l,t){t.d(l,{NG:function(){return a},VP:function(){return n},sS:function(){return r}});const a={FIXED_CONSTANT:{CODE:"0001",NAME:"固定常量"},DROPDOWN_SELECT_INPUT:{CODE:"0002",NAME:"下拉选择"},CASCADER_SELECT_INPUT:{CODE:"0003",NAME:"级联选择 "},COMBINATION_FORMAT_DATA:{CODE:"0004",NAME:"日期类型"},AUTO_INCREMENT_SEQUENCE:{CODE:"0005",NAME:"自增序列"},BAR_CODE_NAME:{CODE:"1001",NAME:"条码名称"}},r={FORM_ITEM_INPUT:{CODE:"0001",NAME:"输入框"},FORM_ITEM_SELECT:{CODE:"0002",NAME:"下拉选择"},FORM_ITEM_CASCADER:{CODE:"0003",NAME:"级联选择"},FORM_ITEM_AUTO_INCREMENT_SEQUENCE:{CODE:"0004",NAME:"自增序列"}},n={GENERATE_TEMPLATE:{CODE:"1",DESC:"生成样式模板"},EXPORT_TEMPLATE:{CODE:"2",DESC:"导出样式模板"}}},3075:function(e,l,t){t.d(l,{G:function(){return n}});var a=t(8626),r=t.n(a);const n=e=>r().cloneDeep(e)},52:function(e,l,t){t.r(l),t.d(l,{default:function(){return h}});var a=t(6768),r=t(4232);const n={style:{"margin-top":"10px"}};function d(e,l,t,d,i,u){const o=(0,a.g2)("el-button"),s=(0,a.g2)("el-col"),c=(0,a.g2)("el-input"),b=(0,a.g2)("el-form-item"),p=(0,a.g2)("el-row"),m=(0,a.g2)("el-table-column"),S=(0,a.g2)("el-table"),E=(0,a.g2)("el-pagination"),g=(0,a.g2)("el-option"),f=(0,a.g2)("el-select"),F=(0,a.g2)("el-switch"),h=(0,a.g2)("el-divider"),y=(0,a.g2)("el-form"),C=(0,a.g2)("el-cascader"),T=(0,a.g2)("el-radio-button"),_=(0,a.g2)("el-radio-group"),O=(0,a.g2)("el-input-number"),N=(0,a.g2)("el-tab-pane"),A=(0,a.g2)("el-tabs"),k=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(p,{style:{"padding-left":"20px","padding-right":"20px","padding-top":"20px"}},{default:(0,a.k6)((()=>[(0,a.bF)(s,{span:2},{default:(0,a.k6)((()=>[(0,a.bF)(o,{type:"success",plain:"",style:{float:"left"},onClick:d.handleOpenAddRuleDialog},{default:(0,a.k6)((()=>[(0,a.eW)("新增规则")])),_:1},8,["onClick"])])),_:1}),(0,a.bF)(s,{span:5},{default:(0,a.k6)((()=>[(0,a.bF)(b,{label:"请输入规则名称："},{default:(0,a.k6)((()=>[(0,a.bF)(c,{modelValue:d.conditions.ruleName,"onUpdate:modelValue":l[0]||(l[0]=e=>d.conditions.ruleName=e),modelModifiers:{lazy:!0},style:{width:"240px"},clearable:"",placeholder:"请输入规则名称"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,a.bF)(p,{style:{"padding-left":"20px","padding-right":"20px"}},{default:(0,a.k6)((()=>[(0,a.bF)(S,{data:d.ruleList,style:{width:"100%",height:"650px"},"cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"}},{default:(0,a.k6)((()=>[(0,a.bF)(m,{type:"index"}),(0,a.bF)(m,{prop:"ruleName",label:"规则名称"}),(0,a.bF)(m,{prop:"ruleNumber",label:"规则编号"}),(0,a.bF)(m,{prop:"scheme.schemeName",label:"所属方案"}),(0,a.bF)(m,{prop:"ruleStatus",formatter:d.ruleStatusFormatter,label:"规则状态"},null,8,["formatter"]),(0,a.bF)(m,{prop:"ruleComments",label:"规则备注"}),(0,a.bF)(m,{prop:"createTime",formatter:d.dateFormatter,sortable:"",label:"创建时间"},null,8,["formatter"]),(0,a.bF)(m,{prop:"updateTime",formatter:d.dateFormatter,sortable:"",label:"更新时间"},null,8,["formatter"]),(0,a.bF)(m,{fixed:"right",label:"操作"},{default:(0,a.k6)((e=>[(0,a.bF)(o,{link:"",type:"primary",onClick:l=>d.handleOpenEditRuleDialog(e.row)},{default:(0,a.k6)((()=>[(0,a.eW)(" 编辑 ")])),_:2},1032,["onClick"]),(0,a.bF)(o,{link:"",type:"primary",onClickOnce:l=>d.handleDeleteRuleById(e.row)},{default:(0,a.k6)((()=>[(0,a.eW)("删除")])),_:2},1032,["onClickOnce"])])),_:1})])),_:1},8,["data"]),(0,a.Lk)("div",n,[(0,a.bF)(E,{"current-page":d.pagingParameters.currentPage,"onUpdate:currentPage":l[1]||(l[1]=e=>d.pagingParameters.currentPage=e),"page-size":d.pagingParameters.pageSize,"onUpdate:pageSize":l[2]||(l[2]=e=>d.pagingParameters.pageSize=e),"page-sizes":[5,10,20,50],layout:"total, sizes, prev, pager, next, jumper",total:d.pagingParameters.total,onSizeChange:d.handlePageSizeChange,onCurrentChange:d.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])),_:1}),(0,a.bF)(k,{modelValue:d.addOrEditRuleDialogVisible,"onUpdate:modelValue":l[9]||(l[9]=e=>d.addOrEditRuleDialogVisible=e),title:d.addOrEditRuleDialogTitle,width:"80%",style:{height:"700px"},"before-close":d.handleCloseDialo},{default:(0,a.k6)((()=>[(0,a.bF)(y,{model:d.rule,"label-width":"auto",rules:d.rules,ref:"ruleFormRef"},{default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(s,{span:11},{default:(0,a.k6)((()=>[(0,a.bF)(b,{label:"规则名称",prop:"ruleName"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{modelValue:d.rule.ruleName,"onUpdate:modelValue":l[3]||(l[3]=e=>d.rule.ruleName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.bF)(s,{span:2}),(0,a.bF)(s,{span:11},{default:(0,a.k6)((()=>[(0,a.bF)(b,{label:"规则编号",prop:"ruleNumber"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{modelValue:d.rule.ruleNumber,"onUpdate:modelValue":l[4]||(l[4]=e=>d.rule.ruleNumber=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(s,{span:11},{default:(0,a.k6)((()=>[(0,a.bF)(b,{label:"方案名称",prop:"schemeId"},{default:(0,a.k6)((()=>[(0,a.bF)(f,{modelValue:d.rule.schemeId,"onUpdate:modelValue":l[5]||(l[5]=e=>d.rule.schemeId=e),placeholder:"请选择方案名称",onChange:d.handleSchemeChange},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(d.schemeOptions,((e,l)=>((0,a.uX)(),(0,a.Wv)(g,{key:l,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1}),(0,a.bF)(s,{span:2}),(0,a.bF)(s,{span:11},{default:(0,a.k6)((()=>[(0,a.bF)(b,{label:"规则状态",prop:"ruleStatus"},{default:(0,a.k6)((()=>[(0,a.bF)(F,{modelValue:d.rule.ruleStatus,"onUpdate:modelValue":l[6]||(l[6]=e=>d.rule.ruleStatus=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.bF)(s,{span:24},{default:(0,a.k6)((()=>[(0,a.bF)(b,{label:"规则备注",prop:"ruleComments"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{modelValue:d.rule.ruleComments,"onUpdate:modelValue":l[7]||(l[7]=e=>d.rule.ruleComments=e),type:"textarea",placeholder:"请输入规则备注"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,a.bF)(h,{"content-position":"center",style:{margin:"10px"}},{default:(0,a.k6)((()=>[(0,a.eW)("编辑规则字段信息")])),_:1}),(0,a.bF)(A,{modelValue:d.currentEditableTabIndex,"onUpdate:modelValue":l[8]||(l[8]=e=>d.currentEditableTabIndex=e),type:"card",editable:"",class:"demo-tabs",onEdit:d.handleTabsEdit},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(d.editableTabs,(e=>((0,a.uX)(),(0,a.Wv)(N,{key:e.name,label:e.title,name:e.name},{default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(s,{span:4},{default:(0,a.k6)((()=>[(0,a.bF)(o,{type:"primary",disabled:d.addRuleFieldButtonIsEnable,onClick:d.handleAddRuleField},{default:(0,a.k6)((()=>[(0,a.eW)("新增规则字段")])),_:1},8,["disabled","onClick"])])),_:1}),(0,a.bF)(s,{span:8},{default:(0,a.k6)((()=>[(0,a.bF)(y,{model:e,"label-width":"auto",rules:d.editableTabRules,ref_for:!0,ref:"editableTabFormRef"},{default:(0,a.k6)((()=>[(0,a.bF)(b,{label:e.barCodeNamePlaceholder,prop:"barCodeName"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{modelValue:e.barCodeName,"onUpdate:modelValue":l=>e.barCodeName=l,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])])),_:2},1032,["model","rules"])])),_:2},1024)])),_:2},1024),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(s,{span:24},{default:(0,a.k6)((()=>[(0,a.bF)(S,{size:"small",data:e.ruleFieldListForEachTab,style:(0,r.Tr)(d.editableTabStyle),"header-row-style":{height:"10px","line-height":"10px"},"cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"}},{default:(0,a.k6)((()=>[(0,a.bF)(m,{type:"index"}),(0,a.bF)(m,{label:"字段类型"},{default:(0,a.k6)((e=>[(0,a.bF)(f,{modelValue:e.row.ruleFieldType,"onUpdate:modelValue":l=>e.row.ruleFieldType=l,placeholder:"请选择字段类型",size:"small",onChange:l=>d.handleRuleFieldTypeChange(e.$index)},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(d.ruleFieldTypeSelectOptions,((e,l)=>((0,a.uX)(),(0,a.Wv)(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,a.bF)(m,{label:"固定常量"},{default:(0,a.k6)((e=>[(0,a.bF)(c,{modelValue:e.row.fixedConstant,"onUpdate:modelValue":l=>e.row.fixedConstant=l,size:"small",disabled:e.row.disabledState.fixedConstant},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,a.bF)(m,{label:"级联选择"},{default:(0,a.k6)((e=>[(0,a.bF)(C,{size:"small",style:{width:"100%"},options:d.cascaderOptions,modelValue:e.row.cascaderSelectedOptions,"onUpdate:modelValue":l=>e.row.cascaderSelectedOptions=l,filterable:"","show-all-levels":!1,onChange:l=>d.handleCascaderChange(e.$index),placeholder:"选择或搜索",clearable:"",disabled:e.row.disabledState.cascaderSelectedOptions,"auto-width":"",ref_for:!0,ref:"cascaderRef"},null,8,["options","modelValue","onUpdate:modelValue","onChange","disabled"])])),_:1}),(0,a.bF)(m,{label:"日期类型"},{default:(0,a.k6)((e=>[(0,a.bF)(f,{modelValue:e.row.dateFormatSelectOption,"onUpdate:modelValue":l=>e.row.dateFormatSelectOption=l,placeholder:"请选择日期格式",size:"small",disabled:e.row.disabledState.dateFormatSelectOption},{default:(0,a.k6)((()=>[(0,a.bF)(g,{label:"YYMM",value:"YYMM"}),(0,a.bF)(g,{label:"YYWS",value:"YYWS"}),(0,a.bF)(g,{label:"YYYY-MM-DD",value:"YYYY-MM-DD"}),(0,a.bF)(g,{label:"YYYY-MM-DD HH:MM:SS",value:"YYYY-MM-DD HH:MM:SS"})])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,a.bF)(m,{label:"自增序列"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{label:"序列进制"},{default:(0,a.k6)((e=>[(0,a.bF)(_,{modelValue:e.row.autoIncrementSequence.binary,"onUpdate:modelValue":l=>e.row.autoIncrementSequence.binary=l,size:"small","is-button":"",disabled:e.row.disabledState.autoIncrementSequence.binary},{default:(0,a.k6)((()=>[(0,a.bF)(T,{label:"10",value:"10"}),(0,a.bF)(T,{label:"16",value:"16"})])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,a.bF)(m,{label:"起始序号"},{default:(0,a.k6)((e=>[(0,a.bF)(O,{size:"small",min:1,"controls-position":"right",style:{width:"100%"},modelValue:e.row.autoIncrementSequence.startSequence,"onUpdate:modelValue":l=>e.row.autoIncrementSequence.startSequence=l,disabled:e.row.disabledState.autoIncrementSequence.startSequence},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,a.bF)(m,{label:"增长步长"},{default:(0,a.k6)((e=>[(0,a.bF)(O,{size:"small",modelValue:e.row.autoIncrementSequence.step,"onUpdate:modelValue":l=>e.row.autoIncrementSequence.step=l,modelModifiers:{number:!0},min:0,"controls-position":"right",style:{width:"100%"},disabled:e.row.disabledState.autoIncrementSequence.step},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1})])),_:1}),(0,a.bF)(m,{label:"补齐策略"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{label:"启用补齐"},{default:(0,a.k6)((e=>[(0,a.bF)(F,{modelValue:e.row.fillStrategy.enable,"onUpdate:modelValue":l=>e.row.fillStrategy.enable=l,size:"small",disabled:e.row.disabledState.fillStrategy.enable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,a.bF)(m,{label:"补齐方向"},{default:(0,a.k6)((e=>[(0,a.bF)(_,{modelValue:e.row.fillStrategy.direction,"onUpdate:modelValue":l=>e.row.fillStrategy.direction=l,size:"small","is-button":"",disabled:e.row.disabledState.fillStrategy.direction},{default:(0,a.k6)((()=>[(0,a.bF)(T,{label:"左",value:"l"}),(0,a.bF)(T,{label:"右",value:"r"})])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,a.bF)(m,{label:"补齐长度"},{default:(0,a.k6)((e=>[(0,a.bF)(O,{size:"small",modelValue:e.row.fillStrategy.length,"onUpdate:modelValue":l=>e.row.fillStrategy.length=l,min:0,"controls-position":"right",style:{width:"100%"},disabled:e.row.disabledState.fillStrategy.length},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,a.bF)(m,{label:"补齐字符"},{default:(0,a.k6)((e=>[(0,a.bF)(c,{modelValue:e.row.fillStrategy.character,"onUpdate:modelValue":l=>e.row.fillStrategy.character=l,size:"small",disabled:e.row.disabledState.fillStrategy.character},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1})])),_:1}),(0,a.bF)(m,{label:"重置策略"},{default:(0,a.k6)((e=>[(0,a.bF)(f,{modelValue:e.row.resetStrategySelectOption,"onUpdate:modelValue":l=>e.row.resetStrategySelectOption=l,placeholder:"请选择自增序列重置策略",size:"small",disabled:e.row.disabledState.resetStrategySelectOption},{default:(0,a.k6)((()=>[(0,a.bF)(g,{label:"每周重置",value:"EW"})])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,a.bF)(m,{label:"操作"},{default:(0,a.k6)((e=>[(0,a.bF)(o,{link:"",type:"primary",onClick:l=>d.handleDeleteRuleField(e.$index)},{default:(0,a.k6)((()=>[(0,a.eW)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:2},1032,["data","style"])])),_:2},1024)])),_:2},1024),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(s,{span:24},{default:(0,a.k6)((()=>[(0,a.bF)(b,null,{default:(0,a.k6)((()=>["ADD"==d.currentUpdateType?((0,a.uX)(),(0,a.Wv)(o,{key:0,type:"primary",onClick:d.handleAddRule},{default:(0,a.k6)((()=>[(0,a.eW)("保存")])),_:1},8,["onClick"])):(0,a.Q3)("",!0),"UPDATE"==d.currentUpdateType?((0,a.uX)(),(0,a.Wv)(o,{key:1,type:"primary",onClick:d.handleUpdateRule},{default:(0,a.k6)((()=>[(0,a.eW)("更新")])),_:1},8,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(o,null,{default:(0,a.k6)((()=>[(0,a.eW)("取消")])),_:1})])),_:1})])),_:1})])),_:1})])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue","onEdit"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","before-close"])],64)}t(4114);var i=t(144),u=t(1219),o=t(7477),s=t(6994),c=t(8992),b=t(5133),p=t(2781),m=t(3075),S=t(1576),E=t.n(S),g={name:"Rule",components:{CaretBottom:o.BHL,CaretTop:o.ziD},setup(){const e=p.NG,l=(0,i.KR)(!1),t=(0,i.KR)("新增规则"),r=(0,i.KR)("UPDATE"),n=(0,i.KR)(!0),d=(0,i.Kh)({width:"100%","pointer-events":"none",height:"300px",overflow:scroll}),o={RULE_TEMPLATE:{ruleName:"",ruleNumber:"",schemeId:"",ruleStatus:!0,ruleComments:"",ruleFieldList:[]},RULE_FIELD_TEMPLATE:{ruleFieldType:"",fixedConstant:"",dropDownSelectOption:"",cascaderSelectedOptions:"",dateFormatSelectOption:"",fillStrategy:{enable:null,direction:null,length:null,character:null},autoIncrementSequence:{binary:null,step:null,startSequence:null},resetStrategySelectOption:null,disabledState:{fixedConstant:!0,dropDownSelectOption:!0,cascaderSelectedOptions:!0,dateFormatSelectOption:!0,autoIncrementSequence:{binary:!0,step:!0,startSequence:!0},resetStrategySelectOption:!0,fillStrategy:{enable:!0,direction:!0,length:!0,character:!0}}}},S=(0,i.Kh)((0,m.G)(o.RULE_TEMPLATE)),g=(0,i.KR)([]),f=(0,i.Kh)({currentPage:1,pageSize:10,total:0});let F=(0,i.KR)(1);const h=(0,i.KR)(1),y=(0,i.KR)([{title:"条码1生成规则",name:1,barCodeNamePlaceholder:"请输入条码1名称",barCodeName:"",ruleFieldListForEachTab:[(0,m.G)(o.RULE_FIELD_TEMPLATE)]}]),C=(0,i.KR)([]),T=(0,i.KR)([]),_=(0,i.KR)([]),O=(0,i.KR)([]),N=(0,i.KR)(null),A=(0,i.KR)(null),k=(0,i.Kh)({ruleName:""}),D=(0,i.Kh)({ruleName:[{required:!0,message:"请输入规则名称",trigger:"blur"},{min:1,max:30,message:"规则名称的长度应该介于1到30之间",trigger:"blur"}],schemeId:[{required:!0,message:"请选择方案名称",trigger:"blur"}],ruleStatus:[{required:!0}]}),I=async()=>{const e=await(0,c.Ox)(f);200==e.code?(g.value=e.data.list,f.total=e.data.total):(0,u.nk)({message:"查询规则列表失败",type:"error",plain:!0})},R=async()=>{O.value=[];const e=await(0,b.or)();if("200"==e.data.code){const l=e.data.data;l.forEach((e=>{O.value.push({label:e.schemeName,value:e.schemeId})}))}else(0,u.nk)({message:"查询方案列表失败",type:"error",plain:!0})};(0,a.sV)((async()=>{I(),Object.keys(e).forEach((l=>{"条码名称"!=e[l]["NAME"]&&"下拉选择"!=e[l]["NAME"]&&T.value.push({label:e[l]["NAME"],value:e[l]["CODE"]})}))}));const M=(e,l)=>{if("add"===l){const e=y.value.length+1,l={title:`条码${e}生成规则`,barCodeNamePlaceholder:`请输入条码${e}名称`,barCodeName:"",name:e,ruleFieldListForEachTab:[(0,m.G)(o.RULE_FIELD_TEMPLATE)]};y.value.push(l),h.value=e}else"remove"===l&&(y.value=y.value.filter((l=>l.name!==e)),y.value.forEach(((e,l)=>{e.title=`条码${l+1}生成规则`,e.barCodeNamePlaceholder=`请输入条码${l+1}名称`,e.barCodeName="",e.name=l+1})),h.value=Math.min(e,y.value.length))},v=()=>{y.value[h.value-1].ruleFieldListForEachTab.push((0,m.G)(o.RULE_FIELD_TEMPLATE))},V=(e,l,t)=>{const a=/[A-Za-z0-9]+/;(l.length<0||l.length>30)&&t(new Error("条码名称的长度应该介于1到30之间")),a.test(l)?t():t(new Error("条码名称只能由英文和数组组成"))},U=(0,i.Kh)({barCodeName:[{required:!0,message:"请输入条码名称",trigger:"blur"},{validator:V,trigger:"blur"}]}),L=(0,i.KR)(null),w=async()=>{const l=[];y.value.forEach(((e,t)=>{const a=L.value[t].validate((e=>(e||(0,u.nk)({message:`请检查[条码${t+1}生成规则]中条码名称是否规范`,type:"error",plain:!0}),e)));l.push(a)}));let t=!0;for(let e=0;e<l.length;e++){const a=await l[e];t=t&&a}if(!t)return t;const a=[],r=[];S.ruleFieldList=[];const n=[];if(n.push(N.value.forEach((e=>{0!=e.getCheckedNodes().length&&n.push(e.getCheckedNodes()[0].label)}))),y.value.forEach(((l,t)=>{l.ruleFieldListForEachTab.forEach(((l,d)=>{let i={};const u=/[1-9][0-9]*/,o=/[A-Za-z0-9]/;switch(l.ruleFieldType){case e.FIXED_CONSTANT.CODE:if(""==l.fixedConstant.trim()){const l=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[${e.FIXED_CONSTANT.NAME}]是否设置了具体的值`;r.push(l)}if(l.fillStrategy.enable){if(!u.test(l.fillStrategy.length)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐长度]是否设置了正确格式的值，只支持支数字`;r.push(e)}if(1!=l.fillStrategy.character.length){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}if(!o.test(l.fillStrategy.character)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}}i={ruleFieldCategoryCode:e.FIXED_CONSTANT.CODE,ruleFieldCategoryName:e.FIXED_CONSTANT.NAME,ruleFieldName:e.FIXED_CONSTANT.NAME,ruleFieldValue:l.fixedConstant,ruleFieldFillStrategy:JSON.stringify(l.fillStrategy),ruleFieldResetStrategy:l.resetStrategySelectOption,ruleFieldAssociationTabIndex:t};break;case e.DROPDOWN_SELECT_INPUT.CODE:if(""==l.dropDownSelectOption.trim()){const l=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[${e.DROPDOWN_SELECT_INPUT.NAME}]是否选择了具体的值`;r.push(l)}if(l.fillStrategy.enable){if(!u.test(l.fillStrategy.length)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐长度]是否设置了正确格式的值，只支持支数字`;r.push(e)}if(1!=l.fillStrategy.character.length){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}if(!o.test(l.fillStrategy.character)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}}i={ruleFieldCategoryCode:e.DROPDOWN_SELECT_INPUT.CODE,ruleFieldCategoryName:e.DROPDOWN_SELECT_INPUT.NAME,ruleFieldName:l.dropDownSelectOption,ruleFieldValue:l.dropDownSelectOption,ruleFieldFillStrategy:JSON.stringify(l.fillStrategy),ruleFieldResetStrategy:l.resetStrategySelectOption,ruleFieldAssociationTabIndex:t};break;case e.CASCADER_SELECT_INPUT.CODE:if(0==l.cascaderSelectedOptions.length){const l=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[${e.CASCADER_SELECT_INPUT.NAME}]是否选择了具体的值`;r.push(l);break}if(l.fillStrategy.enable){if(!u.test(l.fillStrategy.length)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐长度]是否设置了正确格式的值，只支持支数字`;r.push(e)}if(1!=l.fillStrategy.character.length){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}if(!o.test(l.fillStrategy.character)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}break}const s={cascaderOptionValue:l.cascaderSelectedOptions,cascaderOptionLabel:n.shift()};i={ruleFieldCategoryCode:e.CASCADER_SELECT_INPUT.CODE,ruleFieldCategoryName:e.CASCADER_SELECT_INPUT.NAME,ruleFieldName:s.cascaderOptionLabel,ruleFieldValue:JSON.stringify(s),ruleFieldFillStrategy:JSON.stringify(l.fillStrategy),ruleFieldResetStrategy:l.resetStrategySelectOption,ruleFieldAssociationTabIndex:t};break;case e.COMBINATION_FORMAT_DATA.CODE:if(""==l.dateFormatSelectOption.trim()){const l=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[${e.COMBINATION_FORMAT_DATA.NAME}]是否选择了具体的值`;r.push(l)}if(l.fillStrategy.enable){if(!u.test(l.fillStrategy.length)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐长度]是否设置了正确格式的值，只支持支数字`;r.push(e)}if(1!=l.fillStrategy.character.length){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}if(!o.test(l.fillStrategy.character)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}}i={ruleFieldCategoryCode:e.COMBINATION_FORMAT_DATA.CODE,ruleFieldCategoryName:e.COMBINATION_FORMAT_DATA.NAME,ruleFieldName:"日期类型",ruleFieldValue:l.dateFormatSelectOption,ruleFieldFillStrategy:JSON.stringify(l.fillStrategy),ruleFieldResetStrategy:l.resetStrategySelectOption,ruleFieldAssociationTabIndex:t};break;case e.AUTO_INCREMENT_SEQUENCE.CODE:if(!u.test(l.autoIncrementSequence.startSequence)||!u.test(l.autoIncrementSequence.step)){const l=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[${e.AUTO_INCREMENT_SEQUENCE.NAME}-起始序号/增长步长]是否设置了正确格式的值，只支持数字`;r.push(l)}if(l.fillStrategy.enable){if(!u.test(l.fillStrategy.length)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐长度]是否设置了正确格式的值，只支持支数字`;r.push(e)}if(1!=l.fillStrategy.character.length){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}if(!o.test(l.fillStrategy.character)){const e=`请检查[条码${t+1}生成规则]中序号为[${d+1}]的规则字段[补齐策略-补齐字符]是否设置了正确格式的值，只支持支英文和数字，且长度为1`;r.push(e)}}i={ruleFieldCategoryCode:e.AUTO_INCREMENT_SEQUENCE.CODE,ruleFieldCategoryName:e.AUTO_INCREMENT_SEQUENCE.NAME,ruleFieldName:"进制",ruleFieldValue:JSON.stringify(l.autoIncrementSequence),ruleFieldFillStrategy:JSON.stringify(l.fillStrategy),ruleFieldResetStrategy:l.resetStrategySelectOption,ruleFieldAssociationTabIndex:t};break;default:a.push({editableTabIndex:t,fileTypeIndex:d});break}S.ruleFieldList.push(i)}));const d={ruleFieldCategoryCode:e.BAR_CODE_NAME.CODE,ruleFieldCategoryName:"-----",ruleFieldName:"规则名称",ruleFieldValue:l.barCodeName,ruleFieldFillStrategy:"-----",ruleFieldAssociationTabIndex:t};S.ruleFieldList.push(d)})),a.length>0){for(let e=0;e<a.length;e++)return(0,u.nk)({message:`请检查[条码${a[e].editableTabIndex+1}生成规则]中序号为[${a[e].fileTypeIndex+1}]的字段类型选项是否选择了具体的类型`,type:"error",plain:!0}),!1;return!1}if(r.length>0){for(let e=0;e<r.length;e++)return(0,u.nk)({message:`${r[e]}`,type:"error",plain:!0}),!1;return!1}return!0},P=async()=>{const e=await w();if(e)try{A.value.validate((async e=>{if(e){const e=await(0,c.W9)(S);if("200"===e.data.code){(0,u.nk)({message:"保存规则成功",type:"success",plain:!0}),l.value=!1;const e=(0,m.G)(o.RULE_TEMPLATE);Object.keys(e).forEach((l=>{S[l]=e[l]})),I()}else(0,u.nk)({message:"保存规则失败",type:"error",plain:!0})}}))}catch(t){console.log(t)}},$=async()=>{const e=await w();if(e)try{A.value.validate((async e=>{if(e){const e=await(0,c.Ao)(S);if("200"===e.data.code){(0,u.nk)({message:"更新规则成功",type:"success",plain:!0}),l.value=!1;const e=(0,m.G)(o.RULE_TEMPLATE);Object.keys(e).forEach((l=>{S[l]=e[l]})),I()}else(0,u.nk)({message:"更新规则失败",type:"error",plain:!0})}}))}catch(t){console.log(t)}};(0,a.wB)((()=>y.value[h.value-1].ruleFieldListForEachTab),((e,l)=>{e.forEach((e=>{const l=e.fillStrategy.enable;e.disabledState.fillStrategy.direction=!l,e.disabledState.fillStrategy.length=!l,e.disabledState.fillStrategy.character=!l,l?(null==e.fillStrategy.direction&&(e.fillStrategy.direction="l"),null==e.fillStrategy.length&&(e.fillStrategy.length=10),null==e.fillStrategy.character&&(e.fillStrategy.character="0")):(e.fillStrategy.direction=null,e.fillStrategy.length=null,e.fillStrategy.character=null)}))}),{deep:!0});const x=e=>{},q=()=>{l.value=!1},z=async()=>{const e=await(0,s.Wq)({schemeId:S.schemeId,level:2});if("200"==e.data.code){const l=e.data.data;void 0!=l.children&&(C.value=l.children)}else(0,u.nk)({message:"查询下拉选择选项列表失败",type:"error",plain:!0})},W=l=>{const t=y.value[h.value-1].ruleFieldListForEachTab[l];let a=null;switch(t.ruleFieldType){case e.FIXED_CONSTANT.CODE:a=(0,m.G)(o.RULE_FIELD_TEMPLATE),a.ruleFieldType=t.ruleFieldType,a.disabledState.fixedConstant=!1,a.disabledState.fillStrategy.enable=!0,a.disabledState.resetStrategySelectOption=!0,Object.keys(t).forEach((e=>{t[e]=a[e]}));break;case e.DROPDOWN_SELECT_INPUT.CODE:a=(0,m.G)(o.RULE_FIELD_TEMPLATE),a.ruleFieldType=t.ruleFieldType,a.disabledState.dropDownSelectOption=!1,a.disabledState.fillStrategy.enable=!0,a.disabledState.resetStrategySelectOption=!0,Object.keys(t).forEach((e=>{t[e]=a[e]}));break;case e.CASCADER_SELECT_INPUT.CODE:a=(0,m.G)(o.RULE_FIELD_TEMPLATE),a.ruleFieldType=t.ruleFieldType,a.disabledState.cascaderSelectedOptions=!1,a.disabledState.fillStrategy.enable=!0,a.disabledState.resetStrategySelectOption=!0,Object.keys(t).forEach((e=>{t[e]=a[e]}));break;case e.COMBINATION_FORMAT_DATA.CODE:a=(0,m.G)(o.RULE_FIELD_TEMPLATE),a.ruleFieldType=t.ruleFieldType,a.disabledState.dateFormatSelectOption=!1,a.disabledState.fillStrategy.enable=!0,a.disabledState.resetStrategySelectOption=!0,Object.keys(t).forEach((e=>{t[e]=a[e]}));break;case e.AUTO_INCREMENT_SEQUENCE.CODE:a=(0,m.G)(o.RULE_FIELD_TEMPLATE),a.ruleFieldType=t.ruleFieldType,a.disabledState.autoIncrementSequence.binary=!1,a.disabledState.autoIncrementSequence.step=!1,a.disabledState.autoIncrementSequence.startSequence=!1,a.disabledState.fillStrategy.enable=!1,a.disabledState.resetStrategySelectOption=!1,a.autoIncrementSequence.binary="10",a.autoIncrementSequence.step=1,a.autoIncrementSequence.startSequence=1,Object.keys(t).forEach((e=>{"autoIncrementSequence"===e?(t.disabledState.autoIncrementSequence=a.disabledState.autoIncrementSequence,t.autoIncrementSequence=a.autoIncrementSequence):t[e]=a[e]}));break;default:break}},Y=e=>{y.value[h.value-1].ruleFieldListForEachTab.splice(e,1)},K=async()=>{I()},G=async()=>{I()},B=()=>{R(),l.value=!0,t.value="新增规则",r.value="ADD"},X=async a=>{R(),l.value=!0,t.value="编辑规则",r.value="UPDATE",S.id=a.id,S.ruleName=a.ruleName,S.ruleNumber=a.ruleNumber,S.schemeId=a.schemeId,S.ruleStatus="0"==a.ruleStatus,S.ruleComments=a.ruleComments,S.ruleId=a.ruleId,S.createTime=a.createTime,S.updateTime=a.updateTime,z(),y.value=[];const n=a.ruleFieldList[a.ruleFieldList.length-1].ruleFieldAssociationTabIndex+1;for(let e=0;e<n;e++)y.value.push({title:"条码1生成规则",name:1,barCodeNamePlaceholder:"请输入条码1名称",barCodeName:"",ruleFieldListForEachTab:[(0,m.G)(o.RULE_FIELD_TEMPLATE)]});for(let l=0;l<n;l++)y.value[l].title=`条码${l+1}生成规则`,y.value[l].name=l+1,y.value[l].barCodeNamePlaceholder=`请输入条码${l+1}名称`,y.value[l].barCodeName=a.ruleFieldList.filter((t=>t.ruleFieldAssociationTabIndex==l&&t.ruleFieldCategoryCode==e.BAR_CODE_NAME.CODE))[0].ruleFieldValue,a.ruleFieldList.filter((t=>t.ruleFieldAssociationTabIndex==l&&t.ruleFieldCategoryCode!=e.BAR_CODE_NAME.CODE)).forEach(((t,a)=>{const r=(0,m.G)(o.RULE_FIELD_TEMPLATE);switch(r.ruleFieldType=t.ruleFieldCategoryCode,r.fillStrategy=JSON.parse(t.ruleFieldFillStrategy),r.disabledState.fillStrategy.enable=!1,t.ruleFieldCategoryCode){case e.FIXED_CONSTANT.CODE:r.fixedConstant=t.ruleFieldValue,r.disabledState.fixedConstant=!1;break;case e.DROPDOWN_SELECT_INPUT.CODE:r.dropDownSelectOption=t.ruleFieldValue,r.disabledState.dropDownSelectOption=!1;break;case e.CASCADER_SELECT_INPUT.CODE:r.cascaderSelectedOptions=JSON.parse(t.ruleFieldValue).cascaderOptionValue,r.disabledState.cascaderSelectedOptions=!1;break;case e.COMBINATION_FORMAT_DATA.CODE:r.dateFormatSelectOption=t.ruleFieldValue,r.disabledState.dateFormatSelectOption=!1;break;case e.AUTO_INCREMENT_SEQUENCE.CODE:r.autoIncrementSequence=JSON.parse(t.ruleFieldValue),r.disabledState.autoIncrementSequence.binary=!1,r.disabledState.autoIncrementSequence.step=!1,r.disabledState.autoIncrementSequence.startSequence=!1;break;default:break}r.disabledState.resetStrategySelectOption=!1,r.resetStrategySelectOption=t.ruleFieldResetStrategy,y.value[l].ruleFieldListForEachTab[a]=r}))},J=async e=>{const l=await(0,c.qE)(e.id);"200"===l.data.code?((0,u.nk)({message:"删除规则成功",type:"success",plain:!0}),I()):(0,u.nk)({message:"删除规则失败",type:"error",plain:!0})},j=(e,l,t)=>"0"===t?"启用":"停用",Q=(e,l,t)=>E()(t).format("YYYY-MM-DD HH:mm:ss");(0,a.wB)(l,((e,l)=>{if(h.value=1,!e){y.value=[{title:"条码1生成规则",name:1,barCodeNamePlaceholder:"请输入条码1名称",barCodeName:"",ruleFieldListForEachTab:[(0,m.G)(o.RULE_FIELD_TEMPLATE)]}];const e=(0,m.G)(o.RULE_TEMPLATE);Object.keys(e).forEach((l=>{S[l]=e[l]}))}})),(0,a.wB)(k,(async(e,l)=>{if(""==e.ruleName.trim())I();else{const e=await(0,c.KZ)(f,k);200==e.code?g.value=e.data.list:(0,u.nk)({message:"根据名称查询规则列表失败",type:"error",plain:!0})}}));const H=async()=>{z()};return(0,a.wB)(S,((e,l)=>{""==e.schemeId?(d["pointer-events"]="none",n.value=!0):(d["pointer-events"]="auto",n.value=!1)})),{handleAddRuleField:v,addOrEditRuleDialogVisible:l,rule:S,cascaderOptions:C,dateFormatSelectOptions:_,handleCascaderChange:x,handleAddRule:P,handleCloseDialo:q,ruleFieldTypeSelectOptions:T,handleRuleFieldTypeChange:W,tabIndex:F,currentEditableTabIndex:h,editableTabs:y,handleTabsEdit:M,handleDeleteRuleField:Y,cascaderRef:N,schemeOptions:O,rules:D,ruleFormRef:A,ruleList:g,handlePageSizeChange:K,handleCurrentChange:G,pagingParameters:f,editableTabFormRef:L,editableTabRules:U,handleDeleteRuleById:J,ruleStatusFormatter:j,handleOpenAddRuleDialog:B,handleOpenEditRuleDialog:X,addOrEditRuleDialogTitle:t,dateFormatter:Q,handleUpdateRule:$,currentUpdateType:r,conditions:k,handleSchemeChange:H,editableTabStyle:d,addRuleFieldButtonIsEnable:n}}},f=t(1241);const F=(0,f.A)(g,[["render",d]]);var h=F}}]);
//# sourceMappingURL=52.aa9ee6a8.js.map